<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gatot Kaca Search Engine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        .search-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .result-item {
            transition: all 0.3s ease;
        }
        .result-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        .loading {
            display: none;
        }
        .loading.show {
            display: block;
        }
        mark {
            background-color: #fbbf24;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .stat-box {
            background: rgba(255,255,255,0.1);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Header dengan gradient -->
  <div class="search-container text-white py-12">
    <div class="max-w-4xl mx-auto px-6">
      <h1 class="text-4xl font-bold mb-2 text-center">
        <i class="fas fa-shield-alt mr-3"></i>Gatot Kaca Search Engine
      </h1>
      <p class="text-center text-blue-100 mb-8">Temukan informasi tentang sejarah dan wisata Indonesia</p>

      <!-- Search Box -->
      <div class="flex gap-3 max-w-2xl mx-auto">
        <input id="q" type="text" placeholder="Cari informasi tentang Indonesia..." 
          class="flex-1 px-6 py-4 rounded-xl text-gray-800 border-0 focus:outline-none focus:ring-4 focus:ring-blue-300 text-lg shadow-lg"
          onkeypress="handleEnter(event)">
        <button onclick="doSearch()" 
          class="px-8 py-4 bg-yellow-500 text-white rounded-xl hover:bg-yellow-600 font-semibold shadow-lg transition-all duration-200 hover:scale-105">
          <i class="fas fa-search mr-2"></i>Cari
        </button>
      </div>

      <!-- Quick Search Buttons -->
      <div class="flex flex-wrap gap-2 justify-center mt-6">
        <button onclick="quickSearch('sejarah indonesia')" class="stat-box px-4 py-2 rounded-full text-sm hover:bg-white hover:bg-opacity-20 transition-all">
          <i class="fas fa-history mr-1"></i>Sejarah Indonesia
        </button>
        <button onclick="quickSearch('wisata bali')" class="stat-box px-4 py-2 rounded-full text-sm hover:bg-white hover:bg-opacity-20 transition-all">
          <i class="fas fa-map-marker-alt mr-1"></i>Wisata Bali
        </button>
        <button onclick="quickSearch('budaya')" class="stat-box px-4 py-2 rounded-full text-sm hover:bg-white hover:bg-opacity-20 transition-all">
          <i class="fas fa-theater-masks mr-1"></i>Budaya
        </button>
        <button onclick="quickSearch('tradisi')" class="stat-box px-4 py-2 rounded-full text-sm hover:bg-white hover:bg-opacity-20 transition-all">
          <i class="fas fa-hands-helping mr-1"></i>Tradisi
        </button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="max-w-4xl mx-auto px-6 py-8">
    
    <!-- Loading Animation -->
    <div id="loading" class="loading text-center py-8">
      <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      <p class="mt-2 text-gray-600">
        <i class="fas fa-search mr-1"></i>Mencari informasi...
      </p>
    </div>

    <!-- Search Stats -->
    <div id="searchStats" class="hidden mb-6">
      <div class="bg-white rounded-lg p-4 shadow-sm border">
        <p class="text-sm text-gray-600">
          <i class="fas fa-chart-bar mr-1"></i>
          Ditemukan <span id="resultCount" class="font-semibold text-blue-600">0</span> hasil 
          untuk "<span id="queryText" class="font-semibold">-</span>" 
          dalam <span id="searchTime" class="font-semibold">0</span>ms
        </p>
      </div>
    </div>

    <!-- Results -->
    <div id="results" class="space-y-4"></div>

    <!-- No Results Message -->
    <div id="noResults" class="hidden text-center py-12">
      <div class="text-6xl mb-4 text-gray-400">
        <i class="fas fa-search-minus"></i>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-2">Tidak ada hasil ditemukan</h3>
      <p class="text-gray-500 mb-4">Coba kata kunci lain atau periksa ejaan Anda</p>
      <div class="space-x-2">
        <button onclick="quickSearch('sejarah')" class="px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200">
          <i class="fas fa-history mr-1"></i>Cari "sejarah"
        </button>
        <button onclick="quickSearch('wisata')" class="px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200">
          <i class="fas fa-map-marker-alt mr-1"></i>Cari "wisata"
        </button>
      </div>
    </div>

    <!-- Welcome Message -->
    <div id="welcome" class="text-center py-12">
      <div class="text-6xl mb-4 text-red-500">
        <i class="fas fa-flag"></i>
      </div>
      <h2 class="text-2xl font-bold text-gray-800 mb-4">Selamat Datang di Gatot Kaca Search Engine</h2>
      <p class="text-gray-600 mb-6">Jelajahi kekayaan informasi tentang sejarah dan wisata Indonesia</p>
      <div class="grid md:grid-cols-2 gap-6 max-w-2xl mx-auto">
        <div class="bg-white p-6 rounded-xl shadow-sm border hover:shadow-md transition-all">
          <div class="text-3xl mb-3 text-blue-600">
            <i class="fas fa-book-open"></i>
          </div>
          <h3 class="font-semibold mb-2">Sejarah Indonesia</h3>
          <p class="text-sm text-gray-600">Pelajari perjalanan sejarah bangsa Indonesia dari masa ke masa</p>
        </div>
        <div class="bg-white p-6 rounded-xl shadow-sm border hover:shadow-md transition-all">
          <div class="text-3xl mb-3 text-green-600">
            <i class="fas fa-umbrella-beach"></i>
          </div>
          <h3 class="font-semibold mb-2">Wisata Indonesia</h3>
          <p class="text-sm text-gray-600">Temukan destinasi wisata menarik di seluruh nusantara</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-8 mt-12">
    <div class="max-w-4xl mx-auto px-6 text-center">
      <p class="text-gray-400">
        <i class="fas fa-copyright mr-1"></i>2025 Gatot Kaca Search Engine.  anggapuspa
      </p>
    </div>
  </footer>

<script>
let searchStartTime = 0;

// Handle Enter key press
function handleEnter(event) {
  if (event.key === 'Enter') {
    doSearch();
  }
}

// Quick search function
function quickSearch(query) {
  document.getElementById("q").value = query;
  doSearch();
}

// Show/hide elements
function showElement(id) {
  document.getElementById(id).classList.remove('hidden');
}

function hideElement(id) {
  document.getElementById(id).classList.add('hidden');
}

function showLoading() {
  document.getElementById("loading").classList.add('show');
}

function hideLoading() {
  document.getElementById("loading").classList.remove('show');
}

// Main search function
async function doSearch() {
  const q = document.getElementById("q").value.trim();
  if (!q) {
    alert("Silakan masukkan kata kunci pencarian");
    return;
  }

  // Start loading
  searchStartTime = Date.now();
  showLoading();
  hideElement("welcome");
  hideElement("results");
  hideElement("noResults");
  hideElement("searchStats");

  try {
    const res = await fetch(`/search?q=${encodeURIComponent(q)}&limit=20`);
    
    if (!res.ok) {
      throw new Error(`HTTP error! status: ${res.status}`);
    }
    
    const data = await res.json();
    const searchTime = Date.now() - searchStartTime;
    
    hideLoading();
    displayResults(data, q, searchTime);
    
  } catch (error) {
    hideLoading();
    console.error('Search error:', error);
    displayError("Terjadi kesalahan saat mencari. Silakan coba lagi.");
  }
}

// Display search results
function displayResults(data, query, searchTime) {
  const resultsBox = document.getElementById("results");
  resultsBox.innerHTML = "";

  if (data.results.length === 0) {
    showElement("noResults");
    return;
  }

  // Show search stats
  document.getElementById("resultCount").textContent = data.results.length;
  document.getElementById("queryText").textContent = query;
  document.getElementById("searchTime").textContent = searchTime;
  showElement("searchStats");

  // Display results
  data.results.forEach((result, index) => {
    const item = document.createElement("div");
    item.className = "result-item bg-white p-6 rounded-xl shadow-sm border hover:border-blue-200";
    
    const snippet = result.snippet || "Tidak ada preview tersedia.";
    const cleanSnippet = snippet.replace(/<\/?mark>/g, (match) => 
      match === '<mark>' ? '<mark>' : '</mark>'
    );
    
    item.innerHTML = `
      <div class="flex items-start justify-between">
        <div class="flex-1">
          <div class="flex items-center mb-2">
            <span class="inline-block w-6 h-6 bg-blue-100 text-blue-600 rounded-full text-xs flex items-center justify-center font-semibold mr-3">
              ${index + 1}
            </span>
            <h2 class="font-bold text-xl text-gray-800 hover:text-blue-600 transition-colors">
              ${escapeHtml(result.title)}
            </h2>
          </div>
          <p class="text-gray-600 mb-3 leading-relaxed">${cleanSnippet}</p>
          ${result.url ? `
            <a href="${escapeHtml(result.url)}" target="_blank" 
               class="inline-flex items-center text-blue-600 hover:text-blue-800 font-medium text-sm transition-colors">
              <i class="fas fa-external-link-alt mr-2"></i>
              Baca selengkapnya
            </a>
          ` : ''}
        </div>
        <div class="ml-4">
          <div class="w-12 h-12 bg-gradient-to-br from-blue-400 to-purple-500 rounded-lg flex items-center justify-center">
            <i class="fas fa-file-alt text-white text-lg"></i>
          </div>
        </div>
      </div>
    `;
    
    resultsBox.appendChild(item);
  });

  showElement("results");
}

// Display error message
function displayError(message) {
  const resultsBox = document.getElementById("results");
  resultsBox.innerHTML = `
    <div class="bg-red-50 border border-red-200 rounded-xl p-6 text-center">
      <div class="text-4xl mb-3 text-red-500">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <h3 class="text-lg font-semibold text-red-800 mb-2">Terjadi Kesalahan</h3>
      <p class="text-red-600">${message}</p>
      <button onclick="location.reload()" 
              class="mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">
        <i class="fas fa-redo mr-2"></i>Muat Ulang Halaman
      </button>
    </div>
  `;
  showElement("results");
}

// Utility function to escape HTML
function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

// Auto-focus search input when page loads
document.addEventListener('DOMContentLoaded', function() {
  document.getElementById("q").focus();
});

// Add search suggestions (simple implementation)
let searchTimeout;
document.getElementById("q").addEventListener('input', function(e) {
  clearTimeout(searchTimeout);
  const query = e.target.value.trim();
  
  if (query.length >= 2) {
    searchTimeout = setTimeout(() => {
      // Could implement search suggestions here
      console.log('Search suggestion for:', query);
    }, 300);
  }
});
</script>
</body>
</html>
